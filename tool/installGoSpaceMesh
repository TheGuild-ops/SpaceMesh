apt-get update && apt-get upgrade -y < "/dev/null"
sudo apt install curl make clang pkg-config libssl-dev build-essential git jq nodejs -y < "/dev/null"

echo "Enter reward wallet"
read wallet
wget https://golang.org/dl/go1.16.3.linux-amd64.tar.gz
export PATH=$PATH:/usr/local/go/bin
rm -rf /usr/local/go && tar -C /usr/local -xzf go1.16.3.linux-amd64.tar.gz
go version
git clone https://github.com/spacemeshos/go-spacemesh

cd go-spacemesh
git pull
make install
make build
cd build  
cp go-spacemesh /usr/local/bin/spacemesh

#####
wget https://storage.googleapis.com/spacecraft-data/tweedlelite128-archive/config.json -O $HOME/spacemesh/tn1.json

cat <<EOF > /etc/systemd/system/spacemesh.service
[Unit]
Description=SpaceMech
After=network-online.target

[Service]
User=root
TimeoutStartSec=3

ExecStart=/usr/local/bin/spacemesh --tcp-port 7152 --config $HOME/spacemesh/tn1.json -d $HOME/spacemesh/sm_data --coinbase $wallet --start-mining --post-datadir $HOME/spacemesh/post_data

Restart=always
RestartSec=10
LimitNOFILE=65535
KillSignal=SIGTERM

[Install]
WantedBy=multi-user.target
EOF
systemctl daemon-reload
systemctl enable spacemesh
systemctl start spacemesh

journalctl -u spacemesh -f
